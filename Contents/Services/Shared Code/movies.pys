################################################################################
import common
import tmdb

################################################################################
class MovieInfo:
    def __init__(self, torrent_title=''):
        self.title   = torrent_title
        self.year    = ''
        self.tmdb_id = ''
        self.key     = torrent_title

        title_re_result = common.RE_MOVIE_TITLE.search(torrent_title.replace('.', ' '))
        if title_re_result:
            self.title = title_re_result.group(1)
            self.year  = title_re_result.group(3)

            self.tmdb_id, self.title = tmdb.get_tmdb_id_from_title(self.title, self.year)
            self.key                 = self.tmdb_id if self.tmdb_id else self.title

    def to_dict(self):
        return { 
                    'tmdb_id':  self.tmdb_id,
                    'title':    self.title,
                    'year':     self.year,
                    'key':      self.key
               }

    @staticmethod
    def from_tmdb_id(tmdb_id, title, year):
        result         = MovieInfo()
        result.tmdb_id = tmdb_id
        result.title   = title
        result.year    = year
        result.key     = tmdb_id
        return result

    @staticmethod
    def from_dict(dict):
        result          = MovieInfo()
        result.tmdb_id  = dict['tmdb_id']
        result.title    = dict['title']
        result.year     = dict['year']
        result.key      = dict['key']
        return result
